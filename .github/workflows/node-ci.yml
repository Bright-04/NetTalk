name: Node CI

on: [push, pull_request]

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
            - name: Use Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: "16"
            - name: Install dependencies
              run: |
                  # prefer npm ci for reproducible installs when a lockfile is present
                  if [ -f package-lock.json ] || [ -f npm-shrinkwrap.json ]; then
                    echo "Lockfile found, running npm ci"
                    npm ci
                  else
                    echo "No lockfile found, running npm install (will generate a lockfile locally)"
                    npm install
                  fi
            - name: Quick smoke
              run: |
                  node -e "console.log('smoke check')"
